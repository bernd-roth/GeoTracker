<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Running Tracker - Speed & Elevation Display</title>
    <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.1.2/dist/maplibre-gl.css" />
    <link rel="stylesheet" href="styles.css" />
</head>
<body>

<div id="speedDisplay">
    <div class="stats-grid">
        <div class="stat-box">
            <div class="speed-label">Current Speed</div>
            <div class="speed-value" id="currentSpeed">0.0</div>
            <div class="speed-unit">km/h</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Maximum Speed</div>
            <div class="speed-value" id="maxSpeed">0.0</div>
            <div class="speed-unit">km/h</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Average Speed</div>
            <div class="speed-value" id="avgSpeed">0.0</div>
            <div class="speed-unit">km/h</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Moving Average</div>
            <div class="speed-value" id="movingAvg">0.0</div>
            <div class="speed-unit">km/h</div>
        </div>
        <div class="stat-box">
            <div class="elevation-label">Current Altitude</div>
            <div class="elevation-value" id="currentAltitude">0.0</div>
            <div class="elevation-unit">m</div>
        </div>
        <div class="stat-box">
            <div class="elevation-label">Elevation Gain</div>
            <div class="elevation-value" id="elevationGain">0.0</div>
            <div class="elevation-unit">m</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Distance</div>
            <div class="elevation-value" id="totalDistance">0.0</div>
            <div class="elevation-unit">km</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Heart Rate</div>
            <div class="speed-value" id="heartRate">0</div>
            <div class="speed-unit">bpm</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Current Slope</div>
            <div class="elevation-value" id="slope">0.0</div>
            <div class="elevation-unit">%</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Average Slope</div>
            <div class="elevation-value" id="avgSlope">0.0</div>
            <div class="elevation-unit">%</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Max Uphill</div>
            <div class="elevation-value" id="maxUphillSlope">0.0</div>
            <div class="elevation-unit">%</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Max Downhill</div>
            <div class="elevation-value" id="maxDownhillSlope">0.0</div>
            <div class="elevation-unit">%</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Temp Avg</div>
            <div class="speed-value" id="avgTemperature">--</div>
            <div class="speed-unit">°C</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Temp Max</div>
            <div class="speed-value" id="maxTemperature">--</div>
            <div class="speed-unit">°C</div>
        </div>
        <div class="stat-box">
            <div class="speed-label">Temp Min</div>
            <div class="speed-value" id="minTemperature">--</div>
            <div class="speed-unit">°C</div>
        </div>
        <div class="stat-box">
            <div class="elevation-label">Pressure Avg</div>
            <div class="elevation-value" id="avgPressure">--</div>
            <div class="elevation-unit">hPa</div>
        </div>
        <div class="stat-box">
            <div class="elevation-label">Pressure Max</div>
            <div class="elevation-value" id="maxPressure">--</div>
            <div class="elevation-unit">hPa</div>
        </div>
        <div class="stat-box">
            <div class="elevation-label">Pressure Min</div>
            <div class="elevation-value" id="minPressure">--</div>
            <div class="elevation-unit">hPa</div>
        </div>
    </div>
    <div class="hr-mini-chart-container">
        <canvas id="hrMiniChart"></canvas>
    </div>
</div>

<!-- KEEP the Session Manager Panel -->
<div id="sessionManagerPanel" class="control-panel">
    <div class="panel-header">
        <h3>Session Manager</h3>
        <div style="display: flex; gap: 4px; align-items: center;">
            <button id="themeToggleBtn" class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">&#9790;</button>
            <button id="toggleStatsBtn" class="panel-toggle" onclick="toggleStatBoxes()" title="Toggle Stats">S</button>
            <button id="toggleChartsBtn" class="panel-toggle" onclick="toggleCharts()" title="Toggle Charts">C</button>
            <button id="toggleSessionPanel" class="panel-toggle" onclick="toggleSessionPanel()">-</button>
        </div>
    </div>
    <div class="panel-content">
        <div class="session-list-header">
            <h4>Available Sessions</h4>
            <div class="session-controls">
                <button id="refreshSessionsBtn" onclick="requestSessionList()" title="Refresh Sessions">↻</button>
            </div>
        </div>
        <div id="sessionsList" class="sessions-container">
            <p class="no-sessions">No active sessions found.</p>
        </div>
    </div>
</div>

<div id="map"></div>
<div class="charts-container">
    <div id="altitudeChartContainer">
        <canvas id="altitudeChart"></canvas>
    </div>
    <div id="speedChartContainer">
        <canvas id="speedChart"></canvas>
    </div>
</div>
<div id="sessionInfo" class="session-info"></div>

<!-- Debug Popup -->
<!-- <div id="debugOverlay" onclick="toggleDebugPopup()"></div>
<div id="debugPopup">
    <div id="debugPopupHeader">
        <h3 id="debugPopupTitle">Data Trace Debug</h3>
        <button id="debugPopupClose" onclick="toggleDebugPopup()">×</button>
    </div>
    <div id="debugContent"></div>
    <div class="debug-controls">
        <input type="text" id="debugFilter" placeholder="Filter messages..." oninput="filterDebugMessages()">
        <button onclick="clearDebugLog()">Clear Log</button>
        <button onclick="exportDebugLog()">Export Log</button>
        <button onclick="pauseDebugLog()" id="pauseButton">Pause</button>
    </div>
</div> -->

<script src="https://unpkg.com/maplibre-gl@4.1.2/dist/maplibre-gl.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
<script src="script.js"></script>
</body>
</html>
